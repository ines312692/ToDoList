pipeline {
	agent { label 'backend' }

    parameters {
		string(name: 'IMAGE_NAME', defaultValue: 'todo-backend:latest')
        string(name: 'NETWORK_NAME', defaultValue: 'todo-network')
    }

    stages {
		stage('Checkout') {
			steps {
					checkout scm
            }
        }

        stage('Build & Test') {
			steps {
				dir('To_Do_List_Backend') {
                }
            }
        }

        stage('Build Docker Image') {
			steps {
				sh "docker build -t ${params.IMAGE_NAME} To_Do_List_Backend"
            }
        }
    }

    post {
		success {
			echo "Backend build terminé avec succès !"
        }
        failure {
			echo "Backend build échoué."
        }
    }
}